import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.DiEladB3.js";import{u}from"./index.DIEz7UgV.js";import{s as c,r as w,u as h,i as N,c as v}from"./cart.DLN6Tch6.js";import{c as y}from"./shopify.D29yEqNX.js";import{g as k}from"./gql.BxQgxVmM.js";import{P as C}from"./PaymentIcons.B5hD3Hx-.js";import{A as S}from"./AffirmPromotionalMessage.D8TcFvn3.js";import"./index.Dpt-qeBV.js";import"./index.daetGfa_.js";const E=k`
  mutation cartCreate($input: CartInput) {
    cartCreate(input: $input) {
      cart {
        id
        checkoutUrl
      }
      userErrors {
        field
        message
      }
    }
  }
`;function P(){const d=u(N),p=u(v),[j,g]=o.useState(!1),[i,x]=o.useState(!1);o.useEffect(()=>{g(!0)},[]);const a=Object.values(p),n=a.reduce((t,s)=>t+s.price*s.quantity,0),m=n*.07,f=n+m,b=async()=>{x(!0);const t={lines:a.map(s=>({merchandiseId:s.id,quantity:s.quantity}))};console.log("Starting checkout with input:",t);try{const s=await y.request(E,{variables:{input:t}});console.log("Shopify Cart Response:",JSON.stringify(s,null,2));const{data:r}=s;if(r?.cartCreate?.cart?.checkoutUrl){let l=new URL(r.cartCreate.cart.checkoutUrl);l.hostname="dtalles-jewelry.myshopify.com",console.log("Redirecting to:",l.toString()),window.location.href=l.toString()}else console.error("No checkout URL returned",JSON.stringify(s,null,2)),r?.cartCreate?.userErrors?.length>0&&console.error("User Errors:",JSON.stringify(r.cartCreate.userErrors,null,2))}catch(s){console.error("Checkout error:",s)}finally{x(!1)}};return j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed inset-0 bg-black/60 backdrop-blur-sm z-[70] transition-opacity duration-300 ${d?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>c(!1)}),e.jsxs("div",{className:`fixed top-0 right-0 h-full w-full max-w-md bg-[#050505] text-[#FAFAF5] shadow-2xl transform transition-transform duration-300 z-[70] flex flex-col border-l border-[#d4af37]/20 ${d?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-[#d4af37]/10",children:[e.jsx("h2",{className:"text-xl font-serif tracking-wide text-[#d4af37]",children:"Tu Selección"}),e.jsx("button",{onClick:()=>c(!1),className:"text-white/60 hover:text-[#d4af37] transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-2xl",children:"close"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.length>0&&e.jsxs("div",{className:"mb-6 p-4 bg-[#121212] border border-[#d4af37]/20 rounded-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-[#d4af37] font-bold",children:"Estado del Envío"}),e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-white/60",children:"Asegurado 100%"})]}),e.jsx("div",{className:"w-full h-1.5 bg-white/5 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#d4af37] to-white w-full animate-shimmer"})}),e.jsxs("p",{className:"mt-2 text-[11px] text-gray-400 flex items-center gap-1",children:[e.jsx("span",{className:"material-symbols-outlined text-xs text-[#d4af37]",children:"verified"}),"¡Felicidades! Tu orden califica para ",e.jsx("strong",{children:"Envío Express Gratis"})]})]}),a.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center space-y-4 opacity-60",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl text-[#d4af37]",children:"shopping_bag"}),e.jsx("p",{className:"font-light",children:"Tu carrito está vacío."}),e.jsx("button",{onClick:()=>c(!1),className:"text-[#d4af37] underline underline-offset-4 text-sm uppercase tracking-wider hover:text-white",children:"Seguir Comprando"})]}):a.map(t=>e.jsxs("div",{className:"flex gap-4 group",children:[e.jsx("div",{className:"w-24 h-24 bg-[#121212] rounded overflow-hidden relative border border-white/5",children:e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"})}),e.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"font-medium text-white/90 leading-tight group-hover:text-[#d4af37] transition-colors",children:t.title}),e.jsx("button",{onClick:()=>w(t.id),className:"text-white/40 hover:text-red-400 transition-colors",children:e.jsx("span",{className:"material-symbols-outlined text-lg",children:"delete"})})]}),t.variantTitle&&e.jsx("p",{className:"text-sm text-white/50 mt-1",children:t.variantTitle})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center border border-white/10 rounded overflow-hidden",children:[e.jsx("button",{onClick:()=>h(t.id,t.quantity-1),className:"px-3 py-1 hover:bg-white/5 text-white/60 transition-colors",children:"-"}),e.jsx("span",{className:"px-2 text-sm text-[#d4af37] font-bold font-mono",children:t.quantity}),e.jsx("button",{onClick:()=>h(t.id,t.quantity+1),className:"px-3 py-1 hover:bg-white/5 text-white/60 transition-colors",children:"+"})]}),e.jsxs("p",{className:"font-bold text-[#d4af37] tracking-tight",children:["$",(t.price*t.quantity).toLocaleString()]})]})]})]},t.id))]}),a.length>0&&e.jsxs("div",{className:"bg-[#121212] p-6 border-t border-[#d4af37]/10 space-y-4",children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between text-white/60",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{children:["$",n.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-white/60",children:[e.jsx("span",{children:"Envío (Asegurado)"}),e.jsx("span",{className:"text-[#d4af37] font-medium uppercase tracking-widest text-[10px]",children:"GRATIS"})]}),e.jsxs("div",{className:"flex justify-between text-white/60",children:[e.jsx("span",{children:"Impuestos Estimados (7%)"}),e.jsxs("span",{children:["$",m.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-white/5 flex justify-between items-end",children:[e.jsx("span",{className:"text-white/80 font-medium",children:"Total Estimado"}),e.jsxs("span",{className:"text-2xl font-serif text-[#d4af37]",children:["$",f.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("p",{className:"text-xs text-center text-white/40 flex items-center justify-center gap-1 py-1",children:[e.jsx("span",{className:"material-symbols-outlined text-sm text-[#d4af37]",children:"verified_user"}),"Sin cargos ocultos. Transparencia DTalles."]}),e.jsx("div",{className:"flex justify-center w-full",children:e.jsx(S,{price:f,pageType:"cart",className:"mb-2 !mt-0 text-center"})}),e.jsxs("button",{onClick:b,disabled:i,className:`w-full group bg-[#d4af37] text-[#050505] font-bold py-5 uppercase tracking-[0.2em] hover:bg-[#fff] hover:text-[#000] transition-all duration-500 shadow-[0_0_30px_rgba(212,175,55,0.15)] flex justify-center items-center relative overflow-hidden ${i?"opacity-70 cursor-not-allowed":""}`,children:[e.jsx("div",{className:"absolute inset-0 bg-white/20 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"}),i?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-black/30 border-t-black rounded-full animate-spin"}),"Iniciando Pago..."]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-lg",children:"lock"}),e.jsx("span",{children:"Proceder al Pago"})]})]}),e.jsx("div",{className:"flex justify-center pt-2 w-full overflow-hidden",children:e.jsx(C,{className:"flex flex-nowrap justify-center gap-1 sm:gap-1.5",iconClassName:"h-4 w-auto text-white"})})]})]})]}):null}export{P as default};
